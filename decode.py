from PIL import Image

planet = "earth" # Replace this with the name of the planet/moon

planet = planet.upper()
pal = planet + ".PAL"
nor = planet + ".NOR"
sou = planet + ".SOU"

# Default colors
palette = [
    (0, 0, 0),
    (8, 8, 8),
    (16, 16, 16),
    (24, 24, 24),
    (32, 32, 32),
    (40, 40, 40),
    (48, 48, 48),
    (56, 56, 56),
    (65, 65, 65),
    (73, 73, 73),
    (81, 81, 81),
    (89, 89, 89),
    (97, 97, 97),
    (105, 105, 105),
    (113, 113, 113),
    (121, 121, 121),
    (12, 12, 12),
    (28, 28, 28),
    (44, 44, 44),
    (60, 60, 60),
    (77, 77, 77),
    (93, 93, 93),
    (109, 109, 109),
    (125, 125, 125),
    (142, 142, 142),
    (158, 158, 158),
    (174, 174, 174),
    (190, 190, 190),
    (207, 207, 207),
    (223, 223, 223),
    (239, 239, 239),
    (255, 255, 255),
    (12, 4, 4),
    (28, 8, 8),
    (44, 12, 12),
    (60, 16, 16),
    (77, 20, 20),
    (93, 24, 24),
    (109, 28, 28),
    (125, 32, 32),
    (142, 36, 36),
    (158, 40, 40),
    (174, 44, 44),
    (190, 48, 48),
    (207, 52, 52),
    (223, 56, 56),
    (239, 60, 60),
    (255, 65, 65),
    (12, 8, 0),
    (28, 16, 0),
    (44, 24, 0),
    (60, 32, 0),
    (77, 40, 0),
    (93, 48, 0),
    (109, 56, 0),
    (125, 65, 0),
    (142, 73, 0),
    (158, 81, 0),
    (174, 89, 0),
    (190, 97, 0),
    (207, 105, 0),
    (223, 113, 0),
    (239, 121, 0),
    (255, 130, 0),
    (12, 8, 0),
    (28, 24, 0),
    (44, 40, 0),
    (60, 56, 0),
    (77, 73, 0),
    (93, 89, 0),
    (109, 105, 0),
    (125, 121, 0),
    (142, 138, 0),
    (158, 154, 0),
    (174, 170, 0),
    (190, 186, 0),
    (207, 203, 0),
    (223, 219, 0),
    (239, 235, 0),
    (255, 251, 0),
    (0, 12, 0),
    (4, 28, 4),
    (8, 44, 8),
    (12, 60, 12),
    (16, 77, 16),
    (20, 93, 20),
    (24, 109, 24),
    (28, 125, 28),
    (32, 142, 32),
    (36, 158, 36),
    (40, 174, 40),
    (44, 190, 44),
    (48, 207, 48),
    (52, 223, 52),
    (56, 239, 56),
    (60, 255, 60),
    (4, 8, 12),
    (12, 20, 28),
    (20, 32, 44),
    (28, 44, 60),
    (36, 56, 77),
    (44, 69, 93),
    (52, 81, 109),
    (60, 93, 125),
    (69, 105, 142),
    (77, 117, 158),
    (85, 130, 174),
    (93, 142, 190),
    (101, 154, 207),
    (109, 166, 223),
    (117, 178, 239),
    (125, 190, 255),
    (0, 0, 12),
    (0, 0, 28),
    (0, 0, 44),
    (0, 0, 60),
    (0, 0, 77),
    (0, 0, 93),
    (0, 0, 109),
    (0, 0, 125),
    (0, 0, 142),
    (0, 0, 158),
    (0, 0, 174),
    (0, 0, 190),
    (0, 0, 207),
    (0, 0, 223),
    (0, 0, 239),
    (0, 0, 255)
]

# Get the palette colors and convert them into RGB values.

with open(pal, "rb") as f:
    color = f.read(3)
    while color:
        r = ord(color[:1]) * 4
        g = ord(color[1:2]) * 4
        b = ord(color[-1:]) * 4
        palette.append((r, g, b))
        color = f.read(3)
        

# Get the values in the .NOR and .SOU files and get their color.

pixels = []
for file in [nor, sou]:
    pix = []
    with open(file, "rb") as f:
        byte = f.read(1)
        while byte:
            index = ord(byte)
            color = palette[index]
            pix.append(color)
            byte = f.read(1)
            
        # A clunky way to reconstruct the image, but it works.
        img = Image.new("RGB", (256, 256))
        img.putdata(pix)
        left = img.crop((0, 0, 256, 128))
        right = img.crop((0, 128, 256, 256))
        combined = Image.new("RGB", (512, 128))
        combined.paste(left)
        combined.paste(right, (256, 0))
        pixels += combined.getdata()
        
img = Image.new("RGB", (512, 256))
img.putdata(pixels)
img.save(planet + ".PNG")
